function Get-CyberCNSVulnerability {
   <#
      .SYNOPSIS
         Gets all CyberCNS Vulnerabilies or gets all CyberCNS vulnerabilies based on Company
      .EXAMPLE
         $vulns = Get-CyberCNSVulnerability
         $vulns = Get-CyberCNSCompany -Name ACME | Get-CyberCNSVulnerability
         $vulns = Get-CyberCNSVulnerability -CompanyId $company.Id
      .OUTPUTS
         Returns a list of Vulnerabilities
   #>
   [CmdletBinding()]
   param(
      #A Company from the pipeline
      [Parameter(ValueFromPipeline)]
      $Company,
      #The Id of the Company
      [String]
      $CompanyId
   )

   $companyid = ""
   if($Company) {
      $companyid = $Company.Id
   }
   
   if($CompanyId) {
      $companyid = $CompanyId
   }

   $query = Get-CyberCNSQuery -Family "vulnerability" -Species "vulnerability" -CompanyId $companyid
   $queryJson = ($query | ConvertTo-Json -Depth 10 -Compress)
   $params = @{
       skip = 0
       limit = 200
       query = $queryJson
   }

   $RestParams = @{
      "Uri" = [System.Uri]"https://$($CyberCNSApiSession.Url)/vulnerability/api/vulnerabilities"
      "Method" = "GET"
      "Body" = $params
      "ContentType" = "application/json"
   }

   $response = Invoke-RestMethod @RestParams -WebSession $CyberCNSApiSession.Session

   $response
}
